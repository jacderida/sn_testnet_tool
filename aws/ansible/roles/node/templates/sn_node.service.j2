[Unit]
Description=Safe Node

[Service]
{% if is_genesis == "true" %}
ExecStart={{ node_archive_dest_path }}/safenode \
  --root-dir {{ node_data_dir_path }} \
  --port {{ node_port }} \
  --rpc {{ instance_private_ip }}:{{ node_rpc_port }}
{% else %}
ExecStart={{ node_archive_dest_path }}/safenode \
  --root-dir {{ node_data_dir_path }} \
  --port {{ node_port }} \
  --peer {{ genesis_multiaddr }}
{% endif %}
Environment=RUST_LOG={{ rust_log_setting }} \
  RUST_LOG_OTLP={{ rust_log_otlp_setting }} \
  OTLP_SERVICE_NAME={{ instance_name }} \
  OTEL_EXPORTER_OTLP_ENDPOINT={{ otlp_endpoint }}
User={{ ansible_user }}

[Install]
WantedBy=multi-user.target
